{% extends "base.html" %}

{% block title %}{% if purchase %}Edit{% else %}New{% endif %} Purchase - Ethera Jewelry{% endblock %}

{% block content %}
<div class="page-header">
    <div>
        <h1>{% if purchase %}Edit{% else %}New{% endif %} Purchase</h1>
    </div>
    <a href="/purchases" class="btn btn-secondary">Cancel</a>
</div>

<form method="POST" action="{% if purchase %}/purchases/{{ purchase.id }}{% else %}/purchases{% endif %}" style="max-width: 600px;">
    <div class="form-group">
        <label for="material_id">Material *</label>
        <select name="material_id" id="material_id" required>
            <option value="">Select material...</option>
            {% for material in materials %}
            <option value="{{ material.id }}" {% if purchase and purchase.material_id == material.id %}selected{% endif %}>
                {{ material.name }}{% if material.type %} ({{ material.type }}){% endif %}
            </option>
            {% endfor %}
        </select>
    </div>
    
    <div class="form-group">
        <label for="supplier_name">Supplier Name *</label>
        <input type="text" name="supplier_name" id="supplier_name" list="suppliers" value="{% if purchase %}{{ purchase.supplier_name }}{% endif %}" required>
        <datalist id="suppliers">
            {% for supplier in suppliers %}
            <option value="{{ supplier }}">
            {% endfor %}
        </datalist>
    </div>
    
    <div class="form-group">
        <label for="purchase_date">Purchase Date *</label>
        <input type="datetime-local" name="purchase_date" id="purchase_date" 
               value="{% if purchase %}{{ purchase.purchase_date.strftime('%Y-%m-%dT%H:%M') }}{% endif %}" required>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
        <div class="form-group">
            <label for="qty_purchased">Quantity Purchased *</label>
            <input type="number" name="qty_purchased" id="qty_purchased" step="0.01" 
                   value="{% if purchase %}{{ purchase.qty_purchased }}{% endif %}" required>
        </div>
        
        <div class="form-group">
            <label for="unit_cost">Unit Cost *</label>
            <input type="number" name="unit_cost" id="unit_cost" step="0.01" 
                   value="{% if purchase %}{{ purchase.unit_cost }}{% endif %}" required>
        </div>
    </div>
    
    <div class="form-group">
        <label for="currency">Currency *</label>
        <select name="currency" id="currency" required>
            <option value="USD" {% if not purchase or purchase.currency == "USD" %}selected{% endif %}>USD - US Dollar</option>
            <option value="EUR" {% if purchase and purchase.currency == "EUR" %}selected{% endif %}>EUR - Euro</option>
            <option value="GBP" {% if purchase and purchase.currency == "GBP" %}selected{% endif %}>GBP - British Pound</option>
            <option value="JPY" {% if purchase and purchase.currency == "JPY" %}selected{% endif %}>JPY - Japanese Yen</option>
            <option value="CNY" {% if purchase and purchase.currency == "CNY" %}selected{% endif %}>CNY - Chinese Yuan</option>
            <option value="INR" {% if purchase and purchase.currency == "INR" %}selected{% endif %}>INR - Indian Rupee</option>
            <option value="CAD" {% if purchase and purchase.currency == "CAD" %}selected{% endif %}>CAD - Canadian Dollar</option>
            <option value="AUD" {% if purchase and purchase.currency == "AUD" %}selected{% endif %}>AUD - Australian Dollar</option>
            <option value="CHF" {% if purchase and purchase.currency == "CHF" %}selected{% endif %}>CHF - Swiss Franc</option>
            <option value="SGD" {% if purchase and purchase.currency == "SGD" %}selected{% endif %}>SGD - Singapore Dollar</option>
            <option value="TRY" {% if purchase and purchase.currency == "TRY" %}selected{% endif %}>TRY - Turkish Lira</option>
        </select>
    </div>
    
    <div class="form-group">
        <label for="notes">Notes</label>
        <textarea name="notes" id="notes">{% if purchase %}{{ purchase.notes or '' }}{% endif %}</textarea>
    </div>
    
    <div class="actions">
        <button type="submit" class="btn">{% if purchase %}Update{% else %}Create{% endif %} Purchase</button>
    </div>
</form>
{% endblock %}
